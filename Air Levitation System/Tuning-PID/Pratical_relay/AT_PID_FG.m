% Universidade Federal do Piauí                       %
% Campus Ministro Petronio Portela                    %
% Copyright 2022 -José Borges do Carmo Neto-          %
% @author José Borges do Carmo Neto                   %
% @email jose.borges90@hotmail.com                    %
%  PID controllers for the Phase                      %
%  and Gain Margins of the System                     % 
%                                                     %
%  -- Version: 1.0  - 30/04/2022                      %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%% 2 - DADOS rele:

% %u = [0, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47]
% u = [0, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 60, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47]
% ref = 500*ones(size(u))
% %y = [26, 31, 31, 26, 26, 35, 35, 42, 35, 31, 38, 81, 104, 168, 186, 196, 212, 233, 273, 300, 317, 332, 361, 387, 403, 434, 469, 509, 530, 556, 588, 610, 633, 651, 669, 690, 711, 729, 741, 754, 759, 775, 788, 791, 793, 786, 792, 797, 789, 793, 794, 783, 777, 776, 786, 788, 775, 779, 771, 776, 769, 769, 763, 761, 761, 752, 751, 745, 742, 737, 732, 734, 729, 718, 722, 714, 691, 690, 686, 679, 676, 670, 672, 665, 659, 654, 652, 643, 639, 630, 624, 616, 610, 606, 598, 596, 589, 586, 582, 577, 564, 556, 545, 540, 535, 527, 524, 522, 516, 509, 501, 496, 494, 489, 486, 478, 476, 466, 462, 454, 448, 442, 436, 430, 421, 418, 412, 408, 403, 398, 392, 391, 387, 384, 382, 385, 388, 391, 402, 410, 423, 438, 451, 467, 486, 506, 525, 550, 577, 598, 620, 639, 727, 743, 755, 766, 769, 779, 777, 779, 784, 781, 782, 782, 784, 779, 782, 780, 768, 768, 759, 748, 749, 735, 730, 722, 717, 706, 690, 691, 682, 673, 667, 658, 657, 650, 640, 624, 618, 603, 596, 592, 579, 579, 568, 573, 563, 561, 556, 553, 549, 526, 520, 517, 515, 512, 511, 506, 505, 498, 496, 496, 491, 488, 486, 480, 475, 469, 474, 469, 467, 466, 463, 457, 451, 447, 446, 448, 441, 440, 434, 433, 429, 429, 423, 418, 412, 411, 403, 397, 389, 387, 386, 387, 390, 393, 400, 410, 426, 434, 451, 467, 491, 516, 533, 560, 584, 606, 629, 645, 665, 680, 699, 714, 738, 745, 751, 753, 765, 764, 773, 777, 780, 774, 777, 771, 771, 758, 754, 749, 737, 736, 729, 724, 720, 714, 711, 711, 706, 701, 692, 684, 679, 674, 670, 669, 661, 659, 652, 651, 647, 636, 627, 617, 610, 601, 593, 580, 582, 574, 571, 569, 560, 552, 544, 536, 529, 525, 520, 518, 514, 501, 495, 489, 482, 473, 465, 457, 454, 452, 448, 441, 438, 435, 422, 421, 413, 410, 405, 400, 393, 388, 391, 387, 385, 390, 397, 404, 415, 420, 436, 441, 460, 482, 498, 522, 545, 569, 597, 617, 639, 668, 696, 716, 744, 773, 781, 794, 798, 807, 811, 806, 809, 810, 806, 793, 776, 769, 758, 734, 726, 716, 712, 708, 706, 699, 691, 688, 685, 677, 676, 670, 666, 659, 658, 650, 648, 640, 627, 621, 616, 610, 606, 600, 596, 590, 582, 583, 577, 578, 564, 563, 556, 544, 536, 517, 518, 516, 506, 502, 500, 498, 493, 489, 486, 483, 479, 475, 471, 465, 457, 455, 453, 445, 436, 432, 432, 427, 416, 413, 405, 397, 392, 385, 381, 380, 376, 378, 382, 385, 390, 398, 405, 418, 430, 440, 455, 467, 488, 507, 530, 552, 580, 601, 620, 642, 677, 697, 712, 721, 735, 747, 748, 753, 751, 761, 765, 762, 764, 760, 761, 761, 753, 751, 750, 749, 749, 744, 740, 733, 724, 720, 720, 715, 706, 697, 696, 690, 690, 684]
% y  = [26, 27, 30, 28, 30, 27, 29, 29, 28, 28, 30, 28, 33, 31, 33, 34, 38, 31, 26, 33, 41, 41, 65, 80, 96, 108, 122, 125, 147, 160, 177, 205, 221, 235, 249, 264, 278, 298, 307, 326, 340, 352, 367, 374, 404, 421, 432, 452, 474, 493, 520, 539, 555, 588, 611, 619, 652, 674, 690, 699, 702, 710, 719, 731, 727, 725, 725, 734, 728, 720, 719, 718, 711, 700, 694, 690, 684, 677, 669, 659, 655, 645, 644, 632, 622, 616, 604, 594, 593, 580, 571, 563, 551, 542, 532, 525, 514, 508, 497, 488, 474, 466, 460, 451, 438, 428, 417, 408, 401, 393, 385, 377, 368, 359, 356, 351, 348, 348, 351, 353, 359, 372, 379, 385, 395, 410, 419, 436, 453, 465, 484, 497, 517, 532, 550, 569, 592, 609, 626, 647, 665, 677, 693, 704, 711, 720, 729, 731, 740, 747, 746, 746, 743, 751, 750, 753, 745, 719, 710, 707, 627, 552, 356, 317, 338, 378, 487, 594, 609, 760, 788, 832, 831, 827, 819, 813, 812, 806, 797, 789, 783, 774, 769, 757, 743, 733, 730, 715, 704, 691, 679, 676, 666, 659, 649, 643, 632, 625, 613, 614, 604, 594, 589, 577, 566, 560, 545, 536, 531, 523, 516, 509, 499, 489, 480, 476, 467, 459, 451, 442, 437, 426, 415, 407, 396, 388, 381, 377, 369, 361, 356, 351, 354, 360, 366, 376, 384, 395, 409, 423, 446, 463, 478, 507, 533, 566, 585, 633, 662, 688, 701, 712, 723, 731, 748, 754, 766, 775, 773, 773, 777, 774, 769, 761, 757, 751, 743, 737, 726, 724, 711, 708, 697, 688, 682, 677, 671, 662, 651, 637, 631, 621, 612, 601, 596, 586, 578, 571, 563, 552, 541, 530, 526, 517, 504, 496, 487, 473, 464, 455, 450, 442, 433, 427, 417, 405, 400, 387, 377, 374, 367, 370, 372, 377, 382, 391, 403, 417, 422, 432, 444, 461, 476, 492, 511, 544, 565, 585, 600, 624, 642, 666, 689, 701, 720, 735, 743, 745, 756, 755, 755, 755, 751, 748, 743, 735, 733, 724, 717, 710, 700, 695, 688, 680, 669, 658, 649, 639, 628, 616, 607, 597, 588, 580, 575, 562, 556, 540, 528, 521, 510, 502, 492, 485, 475, 464, 454, 443, 434, 429, 413, 400, 392, 382, 374, 370, 364, 363, 365, 370, 376, 391, 397, 408, 421, 436, 460, 496, 514, 538, 565, 584, 598, 623, 635, 652, 672, 689, 709, 720, 744, 753, 764, 763, 768, 762, 757, 749, 719, 713, 709, 703, 695, 686, 674, 663, 661, 651, 639, 629, 602, 585, 580, 568, 561, 552, 545, 539, 531, 525, 514, 505, 502, 493, 487, 475, 463, 456, 448, 440, 435, 421, 413, 402, 394, 388, 377, 363, 357, 348, 348, 353, 355, 359, 361, 373, 386, 395, 406, 419, 430, 444, 455, 482, 499, 518, 534, 552, 575, 596, 620, 640, 658, 674, 694, 707, 727, 736, 748, 759, 764, 769, 781, 787, 786, 786, 789, 791, 786, 788, 786, 783, 777, 778, 774, 768, 761, 757, 746, 743, 741, 731, 725, 720, 717, 708, 706, 695, 690, 685, 676, 672, 662, 659, 653, 645, 634, 624, 622, 610, 603, 590, 588, 580, 576, 568, 560, 552, 546, 528, 522, 487, 467, 448, 426, 413, 398, 380, 361, 364, 412, 464, 503, 529, 570, 613, 627, 652, 686, 712, 760, 769, 769, 766, 763, 764, 759, 752, 744, 741, 737, 734, 731, 719, 717, 710, 706, 698, 689, 679, 672, 662, 656, 649, 637, 626, 626, 617, 610, 603, 598, 588, 582, 574, 564, 559, 554, 544, 534, 531, 522, 508, 502, 495, 487, 480, 471, 466, 459, 451, 440, 435, 428, 420, 409, 402, 396, 387, 381, 376, 368, 367, 365, 363, 375, 388, 415, 454, 469, 504, 537, 561, 577, 598, 620, 635, 656, 669, 690, 701, 716, 726, 736, 743, 751, 758, 759, 765, 766, 769, 774, 774, 776, 773, 776, 776, 770, 763, 762, 754, 751, 743, 738, 729, 719, 710, 711, 703, 696, 689, 681, 675, 666, 660, 646, 638, 631, 620, 611, 602, 593, 583, 576, 564, 549, 539, 531, 520, 509, 503, 498, 487, 482, 473, 461, 458, 446, 438, 430, 421, 410, 400, 395, 385, 383, 374, 368, 365, 366, 372, 369, 374, 379, 383, 398, 407, 417, 427, 443, 459, 474, 487, 506, 522, 537, 556, 573, 592, 607, 633, 649, 672, 694, 711, 728, 741, 746, 760, 760, 765, 769, 769, 764, 761, 756, 755, 747, 746, 738, 729, 723, 717, 710, 706, 698, 694, 683, 676, 664, 656, 641, 632, 625, 615, 602, 595, 586, 580, 570, 562, 552, 544, 537, 528, 513, 506, 498, 489, 479, 468, 455, 444, 434, 422, 408, 399, 387, 374, 364, 359, 359, 367, 378, 388, 397, 406, 422, 465, 481, 499, 523, 542, 559, 574, 597, 617, 641, 661, 681, 694, 705, 712, 727, 736, 744, 743, 739, 743, 739, 732, 732, 733, 722, 718, 716, 714, 704, 697, 691, 694, 686, 678, 665, 657, 654, 640, 635, 631, 621, 612, 608, 594, 588, 583, 570, 562, 551, 543, 535, 527, 520, 509, 501, 492, 487, 479, 471, 462, 457, 442, 428, 395, 366, 356, 347, 340, 343, 353, 363, 375, 385, 397, 408, 427, 448, 474, 497, 519, 549, 573, 595, 622, 647, 674, 695, 719, 739, 742, 762, 770, 774, 781, 787, 789, 795, 798, 794, 790, 786, 785, 774, 769, 761, 759, 755, 746, 742, 736, 730, 721, 716, 706, 696, 687, 679, 669, 667, 659, 648, 637, 633, 617, 610, 610, 603, 598, 588, 585, 578, 571, 563, 556, 546, 539, 532, 523, 516, 508, 503, 493, 487, 476, 468, 463, 452, 447, 439, 432, 425, 417, 407, 399, 391, 379, 372, 365, 363, 360, 367, 370, 377, 386, 395, 408, 425, 445, 459, 480, 492, 510, 528, 546, 563, 584, 597, 620, 633, 650, 667, 679, 695, 709, 718, 736, 746, 757, 762, 770, 772, 778, 779, 767, 777, 766, 760, 761, 757, 748, 750, 737]
% eps = 10
%%

y = [25, 31, 32, 30, 29, 33, 26, 31, 31, 31, 32, 28, 28, 32, 29, 30, 32, 38, 35, 41, 42, 44, 33, 50, 70, 90, 107, 133, 147, 173, 185, 193, 212, 228, 242, 248, 265, 284, 295, 305, 322, 341, 362, 374, 389, 406, 421, 440, 460, 477, 497, 516, 544, 562, 586, 604, 627, 645, 651, 660, 667, 673, 676, 690, 693, 690, 693, 692, 699, 697, 699, 692, 692, 691, 694, 693, 686, 680, 678, 674, 675, 662, 656, 653, 652, 652, 645, 637, 630, 624, 620, 617, 613, 603, 602, 602, 589, 585, 582, 573, 569, 562, 554, 549, 542, 531, 526, 518, 514, 509, 503, 498, 488, 481, 472, 469, 465, 459, 464, 465, 473, 483, 489, 506, 512, 537, 552, 566, 576, 594, 602, 610, 613, 618, 618, 617, 619, 618, 615, 613, 610, 602, 597, 588, 577, 570, 567, 560, 547, 543, 531, 528, 521, 508, 501, 494, 485, 475, 467, 462, 457, 460, 460, 470, 474, 487, 497, 510, 529, 550, 563, 581, 597, 609, 618, 629, 637, 637, 629, 618, 604, 590, 542, 535, 528, 515, 499, 455, 484, 529, 680, 706, 718, 710, 710, 643, 590, 524, 504, 495, 487, 482, 475, 479, 483, 487, 497, 511, 549, 567, 576, 592, 604, 624, 636, 638, 637, 636, 639, 634, 630, 622, 618, 602, 600, 588, 581, 574, 558, 547, 539, 527, 488, 477, 470, 459, 454, 454, 456, 461, 469, 475, 487, 495, 513, 527, 547, 569, 577, 593, 602, 612, 626, 630, 641, 636, 645, 638, 637, 634, 632, 628, 622, 618, 615, 609, 602, 596, 589, 588, 576, 570, 559, 552, 544, 534, 526, 521, 512, 510, 497, 493, 484, 481, 479, 476, 479, 485, 486, 491, 499, 514, 518, 532, 544, 555, 566, 575, 584, 593, 598, 604, 610, 616, 617, 621, 623, 621, 619, 619, 616, 615, 611, 610, 605, 599, 596, 590, 589, 579, 573, 567, 560, 554, 545, 529, 525, 514, 503, 491, 479, 471, 466, 456, 450, 449, 449, 448, 452, 460, 470, 479, 490, 508, 521, 539, 554, 572, 587, 604, 620, 628, 634, 642, 648, 652, 657, 654, 654, 659, 655, 652, 656, 650, 649, 647, 638, 637, 633, 629, 623, 614, 614, 604, 597, 595, 585, 581, 576, 566, 557, 554, 547, 542, 539, 530, 522, 517, 512, 506, 498, 488, 484, 480, 476, 474, 473, 474, 482, 486, 494, 502, 519, 527, 540, 553, 564, 575, 583, 590, 598, 597, 603, 605, 609, 611, 608, 610, 610, 611, 608, 608, 610, 609, 603, 600, 597, 595, 587, 585, 581, 578, 575, 575, 563, 563, 551, 554, 545, 537, 530, 524, 520, 514, 509, 510, 500, 498, 489, 484, 481, 478, 476, 476, 483, 485, 492, 497, 507, 515, 527, 531, 547, 562, 574, 580, 587, 601, 609, 609, 616, 625, 625, 629, 628, 631, 631, 628, 626, 622, 622, 614, 610, 608, 603, 593, 594, 585, 580, 575, 574, 565, 556, 552, 546, 540, 533, 528, 520, 510, 509, 503, 493, 491, 483, 476, 471, 471, 479, 485, 491, 497, 514, 529, 542, 557, 584, 622, 642, 642, 648, 646, 642, 639, 614, 595, 593, 585, 579, 567, 566, 556, 549, 539, 535, 532, 525, 515, 500, 488, 485, 478, 473, 467, 467, 468, 472, 472, 481, 492, 498, 513, 522, 535, 550, 569, 582, 601, 609, 619, 620, 625, 625, 632, 631, 636, 633, 635, 625, 629, 626, 620, 616, 613, 607, 605, 594, 592, 587, 586, 581, 575, 565, 555, 547, 538, 533, 524, 521, 511, 503, 495, 489, 481, 473, 472, 466, 468, 474, 480, 491, 498, 512, 525, 544, 563, 573, 586, 600, 614, 619, 630, 632, 639, 646, 640, 645, 643, 645, 642, 641, 643, 638, 638, 636, 631, 632, 628, 626, 617, 614, 612, 603, 591, 589, 585, 580, 568, 567, 563, 557, 555, 547, 546, 541, 539, 535, 532, 529, 521, 520, 512, 505, 502, 498, 492, 486, 482, 480, 479, 480, 483, 492, 502, 512, 522, 536, 555, 564, 578, 582, 593, 599, 600, 603, 606, 605, 603, 601, 603, 598, 598, 594, 586, 580, 576, 564, 563, 557, 549, 541, 536, 529, 520, 521, 515, 506, 505, 499, 494, 483, 482, 480, 480, 481, 485, 487, 493, 505, 515, 525, 539, 551, 564, 572, 584, 596, 597, 605, 605, 609, 618, 612, 617, 616, 608, 611, 604, 601, 600, 592, 591, 585, 578, 574, 564, 561, 551, 550, 545, 537, 530, 526, 521, 516, 508, 509, 504, 499, 489, 485, 484, 479, 480, 482, 489, 499, 505, 517, 530, 539, 554, 567, 573, 582, 589, 593, 595, 598, 599, 598, 603, 600, 601, 601, 601, 593, 595, 588, 589, 584, 583, 580, 577, 570, 562, 560, 555, 550, 544, 538, 534, 527, 522, 511, 505, 500, 490, 485, 477, 476, 473, 473, 475, 478, 487, 493, 499, 512, 528, 539, 553, 565, 581, 593, 602, 607, 617, 623, 627, 638, 640, 650, 647, 650, 649, 643, 645, 642, 637, 637, 633, 622, 620, 611, 601, 596, 594, 588, 582, 575, 571, 566, 556, 552, 544, 540, 534, 525, 516, 510, 508, 500, 495, 488, 479, 476, 473, 472, 472, 474, 479, 482, 487, 502, 513, 524, 537, 551, 564, 576, 585, 593, 598, 609, 609, 615, 613, 618, 616, 615, 614, 612, 610, 605, 600, 593, 591, 586, 583, 580, 575, 575, 566, 563, 560, 560, 551, 545, 545, 544, 538, 536, 531, 524, 519, 514, 510, 504, 501, 490, 485, 481, 475, 471, 472, 474, 479, 483, 491, 507, 524, 549, 558, 572, 584, 595, 604, 612, 620, 627, 631, 634, 635, 638, 634, 638, 635, 633, 636, 635, 630, 627, 627, 621, 622, 619, 617, 607, 607, 604, 599, 594, 591, 586, 585, 578, 575, 563, 559, 551, 543, 536, 531, 521, 517, 508, 510, 504, 494, 492, 485, 484, 482, 478, 481, 484, 491, 498, 508, 519, 526, 541, 550, 568, 578, 582, 597, 600, 607, 607, 616, 613, 619, 619, 621, 621, 618, 614, 607]
u = [0, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 60, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 60, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47]
eps = 0

%% 2 - DOfinicoes:
Tamostra = 0.06
dh = 60;
dl = 47;
n = 200

ep = eps

Qde_amostras = size(u,2)
nptos = Qde_amostras
t = 1:1:Qde_amostras
Tempo = Tamostra*t
%%
plot(y)
hold on
plot(u)
%% 3 Identificar os parametros a partir do experimento com relé:

    %[gw,w,arm,Kp]=Identificar(n, d, eps,Tamostra,y,u);
    
  maxi=max(y(nptos/2:end));
  mini=min(y(nptos/2:end));
  d=(dh-dl)/2
  a=(maxi-mini)/2
  img=((pi*ep)/(4*d))
  real=((-pi)/(4*d))*sqrt((a^2)-(ep^2))
  g=real-j*img

kont = 0;
for t = 4:Qde_amostras,
   if u(t) ~= u(t-1)
      kont = kont + 1;
      ch(kont) = t;
   end
end
Tu1 = (ch(3) - ch(2))*Tamostra
Tu2 = (ch(4) - ch(3))*Tamostra
Tu = Tu1 + Tu2
w = (2*pi)/(Tu)

% --- Calcula valor de pico positivo
amp_max = eps;
for t =1:Qde_amostras,
   if y(t) >= amp_max  amp_max = y(t); end;
end;
%%
num = 0;
den = 0;
for j=(n/2):(n/2)+ceil(Tu),
    num = num + y(j);
    den = den + u(j);
end
Kp = num/den
  %******************Calculo ganho e fase do processo*******
gw=-(pi*sqrt(a^2-eps^2))/(4*d)
%%
    Ku = -1/gw;
    %Tu = (2*pi)/w; 

    L = 2;
   
    c = 1/Kp;
    b = sin(w*L)/(w*Ku);
    aa = (c + cos(w*L))/(w^2);
    

%% Definições do controlador AT-PID-FG: 
%     Am_min = 2; 
%     Am_max = 5;
%     Theta_m_min = 45;
%     Theta_m_max = 72;
%% Sintonizanodo o PID:
    Am =5;
    Theta_m = (180/2)*(1-(1/Am));
    
    K = (pi/(2*Am*L))*[b;c;aa];
    Kc = K(1);
    Ki = K(2);
    Kd = K(3);
    K
    
%%
Kc
Ti = Kc/Ki
Td = Kd/Kc
